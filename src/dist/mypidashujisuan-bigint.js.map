{"version":3,"sources":["mypidashujisuan-bigint.js"],"names":["myptext","myshurukuangneirong","p","threadgeshu","x","piwei","myworker","eventdata","strt","finishflag","testname","lashentextarea","ids","setTimeout","value","document","getElementById","el","Math","abs","parseInt","style","height","scrollHeight","console","log","outerHTML","mystart","bigInt","n","mul","m","multiply","div","divide","add","__proto__","cmp","compare","myinput1","myinput2","worker1","floor","title","String","time","Date","getTime","length","Worker","i","len","forEach","currentValue","index","arr","undefined","postMessage","onmessage","event","data","p1","max","threadfinish","myeleid3","mytextarea1","mytextarea2","filter","timeEnd","endt","toString","slice","terminate","body","onmousemove","onmouseover","onmousewheel","onscroll","onmousedown","onerror","e","error","message","$","val","alert","ready","mytestpi","click","getConstpinewhighefficiency105","navigator","userAgent","isbigint","BigInt"],"mappings":"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","file":"mypidashujisuan-bigint.js","sourceRoot":"..","sourcesContent":["(() => {\r\n  //使用bigint测试\r\n  //   window.onload = () => {\r\n  //     mytestpi();\r\n  //   };\r\n  // $('window').load(mytestpi)\r\n  $(document).ready(mytestpi);\r\n  // mytestpi;\r\n  var myptext,\r\n    myshurukuangneirong,\r\n    p,\r\n    threadgeshu,\r\n    x,\r\n    piwei,\r\n    myworker,\r\n    eventdata,\r\n    strt,\r\n    finishflag,\r\n    durt,\r\n    testname;\r\n\r\n  function lashentextarea(...ids) {\r\n    setTimeout(function() {\r\n      for (value of ids) {\r\n        var myptext = document.getElementById(value);\r\n        var el = myptext;\r\n\r\n        // textarea.scrollHeight = 60\r\n        // textarea.style.height = \"60px\"\r\n        // makeExpandingArea(textarea);\r\n        if (Math.abs(parseInt(el.style.height) - el.scrollHeight) > 5) {\r\n          console.log(parseInt(el.style.height), el.scrollHeight);\r\n\r\n          myptext.style.height = myptext.scrollHeight + 2 + \"px\";\r\n\r\n          console.log(\r\n            \"拉伸文本框\",\r\n            parseInt(el.style.height),\r\n            el.scrollHeight,\r\n            myptext.outerHTML\r\n          );\r\n        }\r\n      }\r\n    }, 0);\r\n  }\r\n\r\n  function mytestpi() {\r\n    var mystartid = \"#start-big\";\r\n    // document.getElementById(\"start\").onclick = mystart;\r\n    $(mystartid).click(mystart);\r\n    getConstpinewhighefficiency105();\r\n  }\r\n\r\n  function getConstpinewhighefficiency105() {\r\n    var myeleid3 = \"tp-big\";\r\n    var myinput1 = document.getElementById(\"thread-big\");\r\n    var myinput2 = document.getElementById(\"pichangwei-big\");\r\n    var mytextarea1 = document.getElementById(myeleid3);\r\n    myinput1.value = 6;\r\n    myinput2.value = 3;\r\n    // jisuanfinishflag = 1;\r\n    threadgeshu = 8;\r\n    x = 0;\r\n    // piwei = 3000;\r\n\r\n    myptext = mytextarea1;\r\n    myshurukuangneirong = \" \";\r\n    myshurukuangneirong =\r\n      myshurukuangneirong + \"UserAgent: \" + navigator.userAgent + \"\\n\";\r\n      var isbigint=typeof BigInt===\"function\"?'你的浏览器能够支持原生BigInt!':'你的浏览器无法支持原生BigInt!'\r\n      console.log(isbigint)\r\n    myshurukuangneirong = myshurukuangneirong+isbigint + \"\\n开始圆周率多线程测试\\n\";\r\n    myptext.value = myshurukuangneirong;\r\n    // document.getElementById(\"start\").onclick = mystart;\r\n    lashentextarea(myeleid3, \"tp2-big\");\r\n    // setTimeout(function() {\r\n    //   myptext.style.height = myptext.scrollHeight + \"px\";\r\n    // }, 0);\r\n  }\r\n\r\n  function mystart() {\r\n    bigInt.abs = n => bigInt(n).abs();\r\n\r\n    bigInt.mul = (n, m) => bigInt(n).multiply(m);\r\n\r\n    bigInt.div = (n, m) => bigInt(n).divide(m);\r\n    bigInt.add = (n, m) => bigInt(n).add(m);\r\n    bigInt().__proto__.cmp = bigInt().__proto__.compare;\r\n    bigInt().__proto__.div = bigInt().__proto__.divide;\r\n    bigInt().__proto__.mul = bigInt().__proto__.multiply;\r\n    bigInt(\"90071992547409920\").__proto__.cmp = bigInt(\r\n      \"90071992547409920\"\r\n    ).__proto__.compare;\r\n    bigInt(\"90071992547409920\").__proto__.div = bigInt(\r\n      \"90071992547409920\"\r\n    ).__proto__.divide;\r\n    bigInt(\"90071992547409920\").__proto__.mul = bigInt(\r\n      \"90071992547409920\"\r\n    ).__proto__.multiply;\r\n    var myinput1 = document.getElementById(\"thread-big\");\r\n    var myinput2 = document.getElementById(\"pichangwei-big\");\r\n    if (\r\n      myinput1.value >= 1 &&\r\n      myinput1.value <= 12 &&\r\n      myinput2.value >= 1 &&\r\n      myinput2.value <= 100\r\n    ) {\r\n      piwei = 1000 * Math.floor(myinput2.value);\r\n      myinput2.value = Math.floor(myinput2.value);\r\n      threadgeshu = Math.floor(myinput1.value);\r\n      myinput1.value = threadgeshu;\r\n      testname = document.title =\r\n        \"圆周率计算多线程\" + \"-\" + \"线程数为\" + threadgeshu + \"-位数为\" + piwei;\r\n      myshurukuangneirong =\r\n        myshurukuangneirong + \"线程数为\" + threadgeshu + \" \";\r\n      myptext.value = myshurukuangneirong;\r\n      eventdata = \"圆周率计算\" + piwei + \"位 \" + \"计算圆周率中......\" + \"  \\n\";\r\n      // Decimal.precision = piwei\r\n      myshurukuangneirong += String(eventdata);\r\n      myptext.value = myshurukuangneirong;\r\n      console.log(testname);\r\n      console.time(testname);\r\n      strt = new Date().getTime();\r\n      p = new bigInt(0);\r\n\r\n      myworker = [];\r\n      myworker.length = threadgeshu;\r\n\r\n      finishflag = [];\r\n      finishflag.length = threadgeshu;\r\n      var worker1;\r\n      if (typeof worker1 == \"undefined\") {\r\n        worker1 = new Worker(\"mythread1-bigint.js\");\r\n      }\r\n\r\n      for (var i = 0, len = threadgeshu; i < len; i++) {\r\n        myworker[i] = worker1;\r\n      }\r\n\r\n      myworker.forEach(function(currentValue, index, arr) {\r\n        arr[index] = undefined;\r\n\r\n        arr[index] = new Worker(\"mythread1-bigint.js\");\r\n        arr[index].postMessage([piwei, threadgeshu, index]);\r\n        arr[index].onmessage = function(event) {\r\n          console.log(\"主线程从副线程\" + (index + 1) + \"接收\" + \"event.data\\n\");\r\n          console.log(\r\n            \"第一个参数\",\r\n            event.data[0],\r\n            \"\\n第二个参数\",\r\n            event.data[1]\r\n          );\r\n\r\n          var p1 = new bigInt(event.data[0]);\r\n          p = bigInt.add(p, p1);\r\n          x = Math.max(x, parseInt(event.data[1]));\r\n          finishflag[index] = 1;\r\n          threadfinish();\r\n        };\r\n        arr[index].onerror = e => {\r\n          // for (var key in e) {\r\n          //     console.error(key, e[key])\r\n          // }\r\n          // console.error(e.message)\r\n          console.error(\"Error:\", e.message);\r\n          arr[index].terminate();\r\n          $(\"#tp2-big\").val(\"Error:\" + e.message);\r\n          //   throw e;\r\n        };\r\n      });\r\n    } else {\r\n      alert(\"输入错误\");\r\n      myinput2.value = 4;\r\n      myinput1.value = 8;\r\n    }\r\n  }\r\n\r\n  function threadfinish() {\r\n    var myeleid3 = \"tp-big\";\r\n    var myeleid4 = \"tp2-big\";\r\n    var mytextarea1 = document.getElementById(myeleid3);\r\n    var mytextarea2 = document.getElementById(myeleid4);\r\n    if (\r\n      threadgeshu ==\r\n      finishflag.filter(function(currentValue) {\r\n        return currentValue == 1;\r\n      }).length\r\n    ) {\r\n      console.timeEnd(testname);\r\n      var endt = new Date().getTime();\r\n      durt = (endt - strt) / 1000;\r\n\r\n      eventdata =\r\n        \"计算完成,用时\" + durt + \"秒第\" + x + \"次 \" + \"圆周率\" + piwei + \"位\\n\";\r\n      // +\r\n      // \"  \\n\" +\r\n      // p +\r\n      // \"  \\n\"\r\n\r\n      mytextarea2.value =\r\n        \"圆周率\" + piwei + \"位\" + p.toString()[0] + \".\" + p.toString().slice(1);\r\n      var myptext = mytextarea1;\r\n      myshurukuangneirong += String(eventdata);\r\n      myptext.value = myshurukuangneirong;\r\n      // jisuanfinishflag = 1;\r\n      myworker.forEach(function(currentValue, index, arr) {\r\n        arr[index].terminate();\r\n      });\r\n      x = 0;\r\n      //alert(\"ok\")\r\n      setTimeout(function() {\r\n        // myptext.style.height = myptext.scrollHeight + \"px\";\r\n        lashentextarea(myeleid3, myeleid4);\r\n      }, 0);\r\n      document.body.onmousemove = document.body.onmouseover = document.body.onmousewheel = document.body.onscroll = document.body.onmousedown = null;\r\n    }\r\n  }\r\n})();\r\n"]}