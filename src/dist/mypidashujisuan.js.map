{"version":3,"sources":["mypidashujisuan.js"],"names":["myptext","myshurukuangneirong","p","threadgeshu","x","piwei","myworker","eventdata","strt","finishflag","testname","lashentextarea","ids","setTimeout","value","document","getElementById","el","Math","abs","parseInt","style","height","scrollHeight","console","log","outerHTML","mystart","worker1","floor","title","String","Decimal","precision","time","Date","getTime","length","Worker","i","len","forEach","currentValue","index","arr","undefined","postMessage","onmessage","event","data","p1","add","max","threadfinish","filter","timeEnd","endt","toString","terminate","body","onmousemove","onmouseover","onmousewheel","onscroll","onmousedown","onerror","e","error","message","alert","$","ready","mytestpi","click","navigator","userAgent"],"mappings":"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","file":"mypidashujisuan.js","sourceRoot":"..","sourcesContent":["(() => {\r\n  //   window.onload = () => {\r\n  //     mytestpi();\r\n  //   };\r\n  // $('window').load(mytestpi)\r\n  $(document).ready(mytestpi);\r\n  // mytestpi;\r\n  var myptext,\r\n    myshurukuangneirong,\r\n    p,\r\n    threadgeshu,\r\n    x,\r\n    piwei,\r\n    myworker,\r\n    eventdata,\r\n    strt,\r\n    finishflag,\r\n    durt,\r\n    testname;\r\n\r\n  function lashentextarea(...ids) {\r\n    setTimeout(function() {\r\n      for (value of ids) {\r\n        var myptext = document.getElementById(value);\r\n        var el = myptext;\r\n\r\n        // textarea.scrollHeight = 60\r\n        // textarea.style.height = \"60px\"\r\n        // makeExpandingArea(textarea);\r\n        if (Math.abs(parseInt(el.style.height) - el.scrollHeight) > 5) {\r\n          console.log(parseInt(el.style.height), el.scrollHeight);\r\n\r\n          myptext.style.height = myptext.scrollHeight + 2 + \"px\";\r\n          // console.log(\"拉伸文本框\", myptext.outerHTML)\r\n          console.log(\r\n            \"拉伸文本框\",\r\n            parseInt(el.style.height),\r\n            el.scrollHeight,\r\n            myptext.outerHTML\r\n          );\r\n        }\r\n      }\r\n    }, 0);\r\n  }\r\n\r\n  function mytestpi() {\r\n    // document.getElementById(\"start\").onclick = mystart;\r\n    $(\"#start\").click(mystart);\r\n    getConstpinewhighefficiency105();\r\n  }\r\n\r\n  function getConstpinewhighefficiency105() {\r\n    document.getElementById(\"thread\").value = 6;\r\n    document.getElementById(\"pichangwei\").value = 3;\r\n    // jisuanfinishflag = 1;\r\n    threadgeshu = 8;\r\n    x = 0;\r\n    // piwei = 3000;\r\n\r\n    myptext = document.getElementById(\"tp\");\r\n    myshurukuangneirong = \" \";\r\n    myshurukuangneirong =\r\n      myshurukuangneirong + \"UserAgent: \" + navigator.userAgent + \"\\n\";\r\n    myshurukuangneirong = myshurukuangneirong + \"开始圆周率多线程测试\\n\";\r\n    myptext.value = myshurukuangneirong;\r\n    // document.getElementById(\"start\").onclick = mystart;\r\n    lashentextarea(\"tp\", \"tp2\");\r\n    // setTimeout(function() {\r\n    //   myptext.style.height = myptext.scrollHeight + \"px\";\r\n    // }, 0);\r\n  }\r\n\r\n  function mystart() {\r\n    // jisuanfinishflag = 0;\r\n\r\n    if (\r\n      document.getElementById(\"thread\").value >= 1 &&\r\n      document.getElementById(\"thread\").value <= 12 &&\r\n      document.getElementById(\"pichangwei\").value >= 1 &&\r\n      document.getElementById(\"pichangwei\").value <= 100\r\n    ) {\r\n      piwei = 1000 * Math.floor(document.getElementById(\"pichangwei\").value);\r\n      document.getElementById(\"pichangwei\").value = Math.floor(\r\n        document.getElementById(\"pichangwei\").value\r\n      );\r\n      threadgeshu = Math.floor(document.getElementById(\"thread\").value);\r\n      document.getElementById(\"thread\").value = threadgeshu;\r\n      testname = document.title =\r\n        \"圆周率计算多线程\" + \"-\" + \"线程数为\" + threadgeshu + \"-位数为\" + piwei;\r\n      myshurukuangneirong =\r\n        myshurukuangneirong + \"线程数为\" + threadgeshu + \" \";\r\n      myptext.value = myshurukuangneirong;\r\n      eventdata = \"圆周率计算\" + piwei + \"位 \" + \"计算圆周率中......\" + \"  \\n\";\r\n\r\n      myshurukuangneirong += String(eventdata);\r\n      myptext.value = myshurukuangneirong;\r\n      Decimal.precision = piwei;\r\n      console.log(testname);\r\n      console.time(testname);\r\n      strt = new Date().getTime();\r\n      p = new Decimal(0);\r\n\r\n      myworker = [];\r\n      myworker.length = threadgeshu;\r\n\r\n      finishflag = [];\r\n      finishflag.length = threadgeshu;\r\n      var worker1;\r\n      if (typeof worker1 == \"undefined\") {\r\n        worker1 = new Worker(\"mythread1.js\");\r\n      }\r\n\r\n      for (var i = 0, len = threadgeshu; i < len; i++) {\r\n        myworker[i] = worker1;\r\n      }\r\n\r\n      myworker.forEach(function(currentValue, index, arr) {\r\n        arr[index] = undefined;\r\n\r\n        arr[index] = new Worker(\"mythread1.js\");\r\n        arr[index].postMessage([piwei, threadgeshu, index]);\r\n        arr[index].onmessage = function(event) {\r\n          console.log(\"主线程从副线程\" + (index + 1) + \"接收\" + \"event.data\\n\");\r\n          console.log(\r\n            \"第一个参数\",\r\n            event.data[0],\r\n            \"\\n第二个参数\",\r\n            event.data[1]\r\n          );\r\n        //   console.log(...event.data);\r\n\r\n          var p1 = new Decimal(event.data[0]);\r\n          p = Decimal.add(p, p1);\r\n          x = Math.max(x, parseInt(event.data[1]));\r\n          finishflag[index] = 1;\r\n          threadfinish();\r\n        };\r\n        arr[index].onerror = e => {\r\n          console.error(\"Error\", e.message);\r\n          // for (var key in e) {\r\n          //     console.error(key, e[key])\r\n          // }\r\n          // console.error(e)\r\n          arr[index].terminate();\r\n          // throw e;\r\n        };\r\n      });\r\n    } else {\r\n      alert(\"输入错误\");\r\n      document.getElementById(\"pichangwei\").value = 4;\r\n      document.getElementById(\"thread\").value = 8;\r\n    }\r\n  }\r\n\r\n  function threadfinish() {\r\n    if (\r\n      threadgeshu ==\r\n      finishflag.filter(function(currentValue) {\r\n        return currentValue == 1;\r\n      }).length\r\n    ) {\r\n      console.timeEnd(testname);\r\n      var endt = new Date().getTime();\r\n      durt = (endt - strt) / 1000;\r\n\r\n      eventdata =\r\n        \"计算完成,用时\" + durt + \"秒第\" + x + \"次 \" + \"圆周率\" + piwei + \"位\\n\";\r\n      // +\r\n      // \"  \\n\" +\r\n      // p +\r\n      // \"  \\n\"\r\n      document.getElementById(\"tp2\").value =\r\n        \"圆周率\" + piwei + \"位\" + p.toString();\r\n      myptext = document.getElementById(\"tp\");\r\n      myshurukuangneirong += String(eventdata);\r\n      myptext.value = myshurukuangneirong;\r\n      // jisuanfinishflag = 1;\r\n      myworker.forEach(function(currentValue, index, arr) {\r\n        arr[index].terminate();\r\n      });\r\n      x = 0;\r\n      //alert(\"ok\")\r\n      setTimeout(function() {\r\n        // myptext.style.height = myptext.scrollHeight + \"px\";\r\n        lashentextarea(\"tp\", \"tp2\");\r\n      }, 0);\r\n      document.body.onmousemove = document.body.onmouseover = document.body.onmousewheel = document.body.onscroll = document.body.onmousedown = null;\r\n    }\r\n  }\r\n})();\r\n"]}